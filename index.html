<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Loksin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Loksin&#39;s space">
<meta property="og:type" content="website">
<meta property="og:title" content="Loksin">
<meta property="og:url" content="https://l20.github.io/index.html">
<meta property="og:site_name" content="Loksin">
<meta property="og:description" content="Loksin&#39;s space">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Loksin">
<meta property="article:tag" content="loksin">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="blog/atom.xml" title="Loksin" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="blog/css/style.css">

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="blog/" id="logo">Loksin</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="blog/" id="subtitle">Loksin&#39;s space</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="blog/">Home</a>
        
          <a class="main-nav-link" href="blog/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="blog/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://l20.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-2017-05-22-vue-cli" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="blog/2020/01/08/2017-05-22-vue-cli/" class="article-date">
  <time datetime="2020-01-08T07:22:38.449Z" itemprop="datePublished">2020-01-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="blog/2020/01/08/2017-05-22-vue-cli/">2017-05-22-vue-cli</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="vue-cli脚手架分析"><a href="#vue-cli脚手架分析" class="headerlink" title="vue-cli脚手架分析"></a>vue-cli脚手架分析</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p> vue脚手架是帮助用户快速搭建vue模板化、模块化开发的一套命令程序，可根据需要生成相应的模板，用户可以直接在基础模板上开发，省去了用户自搭模板的工序提高开发效率。<br>本文不教授如何使用脚手架搭建项目，旨在分析脚手架然后实现自己的脚手架搭建模板。</p>
<h2 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h2><p>要分析他的实现原理可以到git仓库上把源码clone下来并安装依赖。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 克隆仓库</span></span><br><span class="line">$ git <span class="built_in">clone</span> https://github.com/vuejs/vue-cli</span><br><span class="line"><span class="comment"># 切换目录</span></span><br><span class="line">$ <span class="built_in">cd</span> vue-cli</span><br><span class="line"><span class="comment"># 安装依赖</span></span><br><span class="line">$ npm install</span><br></pre></td></tr></table></figure>

<p>之后打开bin文件夹，这个文件夹是执行vue脚手架的命令如，<code>vue init、vue buil、vue list</code>等.<br>打开之后可以看到有四个文件vue、vue-build、vue-list、vue-init。这几个文件对应的可执行的node脚本程序，对应实现命令功能如下：</p>
<ul>
<li><code>vue</code>:</li>
<li><code>vue-build</code>: </li>
<li><code>vue-init</code>: 初始化模板。</li>
<li><code>vue-list</code>: 罗列所有项目模板。</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://l20.github.io/2020/01/08/2017-05-22-vue-cli/" data-id="ck54z72620006zuwobyu3d1jt" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="blog/2020/01/08/hello-world/" class="article-date">
  <time datetime="2020-01-08T07:22:38.449Z" itemprop="datePublished">2020-01-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="blog/2020/01/08/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://l20.github.io/2020/01/08/hello-world/" data-id="ck54z7267000bzuwo2j9h02rj" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-2017-05-17-nginx-config" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="blog/2017/05/18/2017-05-17-nginx-config/" class="article-date">
  <time datetime="2017-05-18T04:36:00.000Z" itemprop="datePublished">2017-05-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="blog/categories/casper/">casper</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="blog/2017/05/18/2017-05-17-nginx-config/">nginx.config配置文件说明</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="nginx-config文件"><a href="#nginx-config文件" class="headerlink" title="nginx.config文件"></a>nginx.config文件</h3><blockquote>
<p>在nginx目录的config文件夹下,比如<code>/usr/local/nginx/config</code>。</p>
</blockquote>
<h4 id="配置文件的结构"><a href="#配置文件的结构" class="headerlink" title="配置文件的结构"></a>配置文件的结构</h4><hr>
<ul>
<li><p><strong>全局块</strong>：配置影响nginx全局的指令。一般有运行nginx服务器的用户组，nginx进程pid存放路径，日志存放路径，配置文件引入，允许生成worker process数等。</p>
</li>
<li><p><strong>events块</strong>：配置影响nginx服务器或与用户的网络连接。有每个进程的最大连接数，选取哪种事件驱动模型处理连接请求，是否允许同时接受多个网路连接，开启多个网络连接序列化等。</p>
</li>
<li><p><strong>http块</strong>：可以嵌套多个server，配置代理，缓存，日志定义等绝大多数功能和第三方模块的配置。如文件引入，mime-type定义，日志自定义，是否使用sendfile传输文件，连接超时时间，单连接请求数等。</p>
</li>
<li><p><strong>server块</strong>：配置虚拟主机的相关参数，一个http中可以有多个server。</p>
</li>
<li><p><strong>location块</strong>：配置请求的路由，以及各种页面的处理情况。</p>
</li>
</ul>
<h5 id="nginx-config文件说明"><a href="#nginx-config文件说明" class="headerlink" title="nginx.config文件说明"></a>nginx.config文件说明</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#################### 全局块 #####################</span><br><span class="line"></span><br><span class="line">user www www;                                   # 配置用户或者组，默认为nobody nobody。</span><br><span class="line">worker_processes auto;                          # 允许进程数，默认为1</span><br><span class="line"></span><br><span class="line">error_log &#x2F;data&#x2F;wwwlogs&#x2F;error_nginx.log crit;   # 错误日志路径，级别。这个设置可以放入全局块，http块，server块，级别以此为：debug|info|notice|warn|error|crit|alert|emerg</span><br><span class="line">pid &#x2F;var&#x2F;run&#x2F;nginx.pid;                         # nginx进程pid存放路径</span><br><span class="line">worker_rlimit_nofile 51200;                     # 一个进程所能够打开的fd的最大数</span><br><span class="line"></span><br><span class="line">#################### events块 #####################</span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    use epoll;                                  # 事件驱动模型，select|poll|kqueue|epoll|resig|&#x2F;dev&#x2F;poll|eventport</span><br><span class="line">    worker_connections 51200;                   # 每个进程的最大连接数，默认为512</span><br><span class="line">    multi_accept on;                            # 是否允许同时接受多个网路连接，默认为off</span><br><span class="line">    # accept_mutex on;                          # 设置网路连接序列化（是否允许互斥锁），防止惊群现象发生，默认为on</span><br><span class="line">&#125;                                               # 惊群现象：一个网路连接到来，多个睡眠的进程被同事叫醒，但只有一个进程能获得链接，这样会影响系统性能。</span><br><span class="line"></span><br><span class="line">#################### http块 #####################</span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line"></span><br><span class="line">    ################ http全局块 #################</span><br><span class="line"></span><br><span class="line">    #可以嵌套多个server，配置代理</span><br><span class="line"></span><br><span class="line">    include mime.types;                          # 文件扩展名与文件类型映射表              </span><br><span class="line">    default_type application&#x2F;octet-stream;       # 默认文件类型，默认为text&#x2F;plain</span><br><span class="line">    #access_log off;                             # 取消服务日志           </span><br><span class="line">    server_names_hash_bucket_size 128;</span><br><span class="line">    client_header_buffer_size 32k;</span><br><span class="line">    large_client_header_buffers 4 32k;</span><br><span class="line">    client_max_body_size 1024m;</span><br><span class="line">    # sendfile_max_chunk 100k;                   # 每个进程每次调用传输数量不能大于设定的值，默认为0，即不设上限。</span><br><span class="line">    sendfile on;                                 # 允许sendfile方式传输文件，默认为off，可以在http块，server块，location块。</span><br><span class="line">    tcp_nopush on;</span><br><span class="line">    keepalive_timeout 120;                       # 连接超时时间，默认为75s，可以在http，server，location块。</span><br><span class="line"></span><br><span class="line">    server_tokens off;</span><br><span class="line">    tcp_nodelay on;</span><br><span class="line"></span><br><span class="line">    fastcgi_connect_timeout 300;</span><br><span class="line">    fastcgi_send_timeout 300;</span><br><span class="line">    fastcgi_read_timeout 300;</span><br><span class="line">    fastcgi_buffer_size 64k;</span><br><span class="line">    fastcgi_buffers 4 64k;</span><br><span class="line">    fastcgi_busy_buffers_size 128k;</span><br><span class="line">    fastcgi_temp_file_write_size 128k;</span><br><span class="line"></span><br><span class="line">    #Gzip Compression</span><br><span class="line">    gzip on;</span><br><span class="line">    gzip_buffers 16 8k;</span><br><span class="line">    gzip_comp_level 6;</span><br><span class="line">    gzip_http_version 1.1;</span><br><span class="line">    gzip_min_length 256;</span><br><span class="line">    gzip_proxied any;</span><br><span class="line">    gzip_vary on;</span><br><span class="line">    gzip_types</span><br><span class="line">        text&#x2F;xml application&#x2F;xml application&#x2F;atom+xml application&#x2F;rss+xml application&#x2F;xhtml+xml image&#x2F;svg+xml</span><br><span class="line">        text&#x2F;javascript application&#x2F;javascript application&#x2F;x-javascript</span><br><span class="line">        text&#x2F;x-json application&#x2F;json application&#x2F;x-web-app-manifest+json</span><br><span class="line">        text&#x2F;css text&#x2F;plain text&#x2F;x-component</span><br><span class="line">        font&#x2F;opentype application&#x2F;x-font-ttf application&#x2F;vnd.ms-fontobject</span><br><span class="line">        image&#x2F;x-icon;</span><br><span class="line">    gzip_disable &quot;MSIE [1-6]\.(?!.*SV1)&quot;;</span><br><span class="line"></span><br><span class="line">    #If you have a lot of static files to serve through Nginx then caching of the files&#39; metadata (not the actual files&#39; contents) can save some latency.</span><br><span class="line">    open_file_cache max&#x3D;1000 inactive&#x3D;20s;</span><br><span class="line">    open_file_cache_valid 30s;</span><br><span class="line">    open_file_cache_min_uses 2;</span><br><span class="line">    open_file_cache_errors on;</span><br><span class="line"></span><br><span class="line">    # error_page 404 https:&#x2F;&#x2F;www.error.com;     #错误页</span><br><span class="line"></span><br><span class="line">    ################ http server块 #################</span><br><span class="line">   </span><br><span class="line">    # 配置虚拟主机的相关参数，一个http中可以有多个server。</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen 80;                                          # 监听端口</span><br><span class="line">        server_name _;                                      # 监听地址     </span><br><span class="line">        access_log &#x2F;data&#x2F;wwwlogs&#x2F;access_nginx.log combined; # combined为日志格式的默认值</span><br><span class="line">        root &#x2F;data&#x2F;wwwroot&#x2F;default;                         # 根目录</span><br><span class="line">        index index.html index.htm index.php;</span><br><span class="line"></span><br><span class="line">####################### 配置请求的路由，以及各种页面的处理情况。###########################</span><br><span class="line"></span><br><span class="line">        location &#x2F;nginx_status &#123;   # 请求的url过滤，正则匹配，下同</span><br><span class="line">            stub_status on;</span><br><span class="line">            access_log off;</span><br><span class="line">            allow 127.0.0.1;       # 允许的ip  </span><br><span class="line">            deny all;              # 拒绝的ip</span><br><span class="line">            &#125;</span><br><span class="line">        location ~ [^&#x2F;]\.php(&#x2F;|$) &#123;</span><br><span class="line">            #fastcgi_pass remote_php_ip:9000;</span><br><span class="line">            fastcgi_pass unix:&#x2F;dev&#x2F;shm&#x2F;php-cgi.sock;</span><br><span class="line">            fastcgi_index index.php;</span><br><span class="line">            include fastcgi.conf;</span><br><span class="line">            &#125;</span><br><span class="line">        location ~ .*\.(gif|jpg|jpeg|png|bmp|swf|flv|ico)$ &#123;</span><br><span class="line">            expires 30d;</span><br><span class="line">            access_log off;</span><br><span class="line">            &#125;</span><br><span class="line">        location ~ .*\.(js|css)?$ &#123;</span><br><span class="line">            expires 7d;</span><br><span class="line">            access_log off;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">########################## 第三方模配置导入 #############################</span><br><span class="line">    include vhost&#x2F;*.conf;       # 可以是用户自定义的配置模块</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>配置完成之后可通过命令<code>#/usr/local/nginx/sbin/nginx -s reload</code>重启nginx生效</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://l20.github.io/2017/05/18/2017-05-17-nginx-config/" data-id="ck54z72610005zuwo9uzkb6ao" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="blog/tags/IT-%E5%89%8D%E7%AB%AF/" rel="tag">IT 前端</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2017-05-17-nginx-1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="blog/2017/05/17/2017-05-17-nginx-1/" class="article-date">
  <time datetime="2017-05-17T09:31:00.000Z" itemprop="datePublished">2017-05-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="blog/categories/casper/">casper</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="blog/2017/05/17/2017-05-17-nginx-1/">nginx学习笔记——架构</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><blockquote>
<p><a href="http://baike.baidu.com/link?url=h2rNmCua5QFugIIfSwQBILZViXrI3KBhUCatiFSTAYZRmxmzuySxL_HwwZaELBNoA4gSxhK-PrGYO2UzbF4lqK" target="_blank" rel="noopener">nginx</a>是一个高性能的HTTP和反向代理服务器，也是一个IMAP/POP3/SMTP服务器。一般在Unix系统上运行。(摘自百度百科)</p>
</blockquote>
<h3 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h3><img src="https://img.alicdn.com/imgextra/i4/690341282/TB2fc3pXmvHfKJjSZFPXXbttpXa_!!690341282.png" alt=" chapter-2-1.png"/>

<h5 id="1-nginx启动后，在unix系统中会以daemon的方式在后台运行-这些后台进程包含一个master进程和多个worker进程。"><a href="#1-nginx启动后，在unix系统中会以daemon的方式在后台运行-这些后台进程包含一个master进程和多个worker进程。" class="headerlink" title="1.nginx启动后，在unix系统中会以daemon的方式在后台运行,,这些后台进程包含一个master进程和多个worker进程。"></a>1.nginx启动后，在unix系统中会以<a href="http://www.cnblogs.com/li-hao/archive/2013/02/22/2922120.html" target="_blank" rel="noopener">daemon</a>的方式在后台运行,,这些后台进程包含一个master进程和多个worker进程。</h5><h5 id="2-nginx支持多线程和多进程方式，主流是多进程（nginx的默认方式）。"><a href="#2-nginx支持多线程和多进程方式，主流是多进程（nginx的默认方式）。" class="headerlink" title="2.nginx支持多线程和多进程方式，主流是多进程（nginx的默认方式）。"></a>2.nginx支持多线程和多进程方式，主流是多进程（nginx的默认方式）。</h5><h5 id="3-master进程主要用来管理worker进程，接收来自外界的信号，向各worker进程发送信号，监控worker进程的运行状态。worker退出会自动启动新的worker进程。一个请求，只可能在一个worker进程中处理，一个worker进程，不可能处理其它进程的请求。"><a href="#3-master进程主要用来管理worker进程，接收来自外界的信号，向各worker进程发送信号，监控worker进程的运行状态。worker退出会自动启动新的worker进程。一个请求，只可能在一个worker进程中处理，一个worker进程，不可能处理其它进程的请求。" class="headerlink" title="3.master进程主要用来管理worker进程，接收来自外界的信号，向各worker进程发送信号，监控worker进程的运行状态。worker退出会自动启动新的worker进程。一个请求，只可能在一个worker进程中处理，一个worker进程，不可能处理其它进程的请求。"></a>3.master进程主要用来管理worker进程，接收来自外界的信号，向各worker进程发送信号，监控worker进程的运行状态。worker退出会自动启动新的worker进程。一个请求，只可能在一个worker进程中处理，一个worker进程，不可能处理其它进程的请求。</h5><h5 id="4-worker进程的个数是可以设置的，一般我们会设置与机器cpu核数一致。"><a href="#4-worker进程的个数是可以设置的，一般我们会设置与机器cpu核数一致。" class="headerlink" title="4.worker进程的个数是可以设置的，一般我们会设置与机器cpu核数一致。"></a>4.worker进程的个数是可以设置的，一般我们会设置与机器cpu核数一致。</h5><h5 id="5-老式操作nginx方式，用户可以给master进程发型不同类型的信号，让master进程来管理worker进程干不同的事情；新的操作方式，nginx在0-8版本之后，引入了一系列命令行参数，来方便管理，比如，-nginx-s-reload，就是来重启nginx。"><a href="#5-老式操作nginx方式，用户可以给master进程发型不同类型的信号，让master进程来管理worker进程干不同的事情；新的操作方式，nginx在0-8版本之后，引入了一系列命令行参数，来方便管理，比如，-nginx-s-reload，就是来重启nginx。" class="headerlink" title="5.老式操作nginx方式，用户可以给master进程发型不同类型的信号，让master进程来管理worker进程干不同的事情；新的操作方式，nginx在0.8版本之后，引入了一系列命令行参数，来方便管理，比如，./nginx -s reload，就是来重启nginx。"></a>5.老式操作nginx方式，用户可以给master进程发型不同类型的信号，让master进程来管理worker进程干不同的事情；新的操作方式，nginx在0.8版本之后，引入了一系列命令行参数，来方便管理，比如，./nginx -s reload，就是来重启nginx。</h5><h5 id="6-master进程在接到信号后，会先重新加载配置文件，然后再启动新的worker进程，并向所有老的worker进程发送信号，告诉他们退出。若老的进程有未处理完的任务则先等任务处理完成才退出，进程接收到信号之后不在接收任何请求任务。"><a href="#6-master进程在接到信号后，会先重新加载配置文件，然后再启动新的worker进程，并向所有老的worker进程发送信号，告诉他们退出。若老的进程有未处理完的任务则先等任务处理完成才退出，进程接收到信号之后不在接收任何请求任务。" class="headerlink" title="6.master进程在接到信号后，会先重新加载配置文件，然后再启动新的worker进程，并向所有老的worker进程发送信号，告诉他们退出。若老的进程有未处理完的任务则先等任务处理完成才退出，进程接收到信号之后不在接收任何请求任务。"></a>6.master进程在接到信号后，会先重新加载配置文件，然后再启动新的worker进程，并向所有老的worker进程发送信号，告诉他们退出。若老的进程有未处理完的任务则先等任务处理完成才退出，进程接收到信号之后不在接收任何请求任务。</h5><h5 id="7-worker进程处理请求流程："><a href="#7-worker进程处理请求流程：" class="headerlink" title="7.worker进程处理请求流程："></a>7.worker进程处理请求流程：</h5><ul>
<li><input checked="" disabled="" type="checkbox"> ①建立好需要listen的socket（listenfd文件描述符）。</li>
<li><input checked="" disabled="" type="checkbox"> ②master  进程fork多个worker进程。</li>
<li><input checked="" disabled="" type="checkbox"> ③worker进程的listenfd变为可读。</li>
<li><input checked="" disabled="" type="checkbox"> ④所有worker进程抢占互斥锁<a href="http://www.linuxidc.com/Linux/2012-01/50917p6.htm" target="_blank" rel="noopener">accept_mutex</a>。</li>
<li><input checked="" disabled="" type="checkbox"> ⑤抢到的那个进程注册listenfd读事件，在读事件里调用accept接受该连接。</li>
<li><input checked="" disabled="" type="checkbox"> ⑥读取请求，解析请求，处理请求，产生数据后，再返回给客户端。</li>
<li><input checked="" disabled="" type="checkbox"> ⑦断开链接。</li>
</ul>
<p>（注：一个请求，完全由worker进程来处理，而且只在一个worker进程中处理。）</p>
<h5 id="8-nginx采用了异步非阻塞的方式来处理请求（网络事件），有体到系统调用就是像select-poll-epoll-kqueue这样的系统调用。关IO多路复用的解释请点开。"><a href="#8-nginx采用了异步非阻塞的方式来处理请求（网络事件），有体到系统调用就是像select-poll-epoll-kqueue这样的系统调用。关IO多路复用的解释请点开。" class="headerlink" title="8.nginx采用了异步非阻塞的方式来处理请求（网络事件），有体到系统调用就是像select/poll/epoll/kqueue这样的系统调用。关IO多路复用的解释请点开。"></a>8.nginx采用了异步非阻塞的方式来处理请求（网络事件），有体到系统调用就是像select/poll/epoll/kqueue这样的系统调用。关IO<a href="https://www.zhihu.com/question/32163005" target="_blank" rel="noopener">多路复用</a>的解释请点开。</h5><h5 id="9-事件通常有三种类型，网络事件、信号、定时器-网络事件通过异步非阻塞来解决-8中-。信号，若nginx正在等待事件（epoll-wait时），如果收到信号，在信号处理函数处理完后，epoll-wait会返回错误，然后程序可再次进入epoll-wait调用。定时器，epoll-wait函数在调用的时候可以设置一个超时时间nginx借助这个超时时间来实现定时器，当没有事件产生，也没有中断信号时，epoll-wait会超时，也就是说，定时器事件到了。之后，nginx会检查所有的超时事件，将他们的状态设置为超时，然后再去处理网络事件，因此在处理网络事件的回调函数时，通常做的第一个事情就是判断超时，然后再去处理网络事件。"><a href="#9-事件通常有三种类型，网络事件、信号、定时器-网络事件通过异步非阻塞来解决-8中-。信号，若nginx正在等待事件（epoll-wait时），如果收到信号，在信号处理函数处理完后，epoll-wait会返回错误，然后程序可再次进入epoll-wait调用。定时器，epoll-wait函数在调用的时候可以设置一个超时时间nginx借助这个超时时间来实现定时器，当没有事件产生，也没有中断信号时，epoll-wait会超时，也就是说，定时器事件到了。之后，nginx会检查所有的超时事件，将他们的状态设置为超时，然后再去处理网络事件，因此在处理网络事件的回调函数时，通常做的第一个事情就是判断超时，然后再去处理网络事件。" class="headerlink" title="9.事件通常有三种类型，网络事件、信号、定时器,网络事件通过异步非阻塞来解决(8中)。信号，若nginx正在等待事件（epoll_wait时），如果收到信号，在信号处理函数处理完后，epoll_wait会返回错误，然后程序可再次进入epoll_wait调用。定时器，epoll_wait函数在调用的时候可以设置一个超时时间nginx借助这个超时时间来实现定时器，当没有事件产生，也没有中断信号时，epoll_wait会超时，也就是说，定时器事件到了。之后，nginx会检查所有的超时事件，将他们的状态设置为超时，然后再去处理网络事件，因此在处理网络事件的回调函数时，通常做的第一个事情就是判断超时，然后再去处理网络事件。"></a>9.事件通常有三种类型，网络事件、信号、定时器,网络事件通过异步非阻塞来解决(8中)。信号，若nginx正在等待事件（epoll_wait时），如果收到信号，在信号处理函数处理完后，epoll_wait会返回错误，然后程序可再次进入epoll_wait调用。定时器，epoll_wait函数在调用的时候可以设置一个超时时间nginx借助这个超时时间来实现定时器，当没有事件产生，也没有中断信号时，epoll_wait会超时，也就是说，定时器事件到了。之后，nginx会检查所有的超时事件，将他们的状态设置为超时，然后再去处理网络事件，因此在处理网络事件的回调函数时，通常做的第一个事情就是判断超时，然后再去处理网络事件。</h5><h5 id="事件处理模型："><a href="#事件处理模型：" class="headerlink" title="事件处理模型："></a>事件处理模型：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">while (1) &#123;</span><br><span class="line">    for (t in run_tasks) &#123; &#x2F;* 任务队列 *&#x2F;</span><br><span class="line">        t.handler();</span><br><span class="line">    &#125;</span><br><span class="line">    update_time(&amp;now);</span><br><span class="line">    timeout &#x3D; ETERNITY;</span><br><span class="line">    for (t in wait_tasks) &#123; &#x2F;* 循环处理等待队列 *&#x2F;</span><br><span class="line">        if (t.time &lt;&#x3D; now) &#123;    &#x2F;&#x2F; 判断超时</span><br><span class="line">            t.timeout_handler(); &#x2F;&#x2F; 处理网络事件 </span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            timeout &#x3D; t.time - now;</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    nevents &#x3D; poll_function(events, timeout);</span><br><span class="line">    for (i in nevents) &#123;</span><br><span class="line">        task t;</span><br><span class="line">        if (events[i].type &#x3D;&#x3D; READ) &#123;</span><br><span class="line">            t.handler &#x3D; read_handler;</span><br><span class="line">        &#125; else &#123; &#x2F;* events[i].type &#x3D;&#x3D; WRITE *&#x2F;</span><br><span class="line">            t.handler &#x3D; write_handler;</span><br><span class="line">        &#125;</span><br><span class="line">        run_tasks_add(t);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://l20.github.io/2017/05/17/2017-05-17-nginx-1/" data-id="ck54z725v0001zuwohhr0ees6" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="blog/tags/IT-%E5%89%8D%E7%AB%AF/" rel="tag">IT 前端</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2017-05-17-nginx-2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="blog/2017/05/17/2017-05-17-nginx-2/" class="article-date">
  <time datetime="2017-05-17T09:31:00.000Z" itemprop="datePublished">2017-05-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="blog/categories/casper/">casper</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="blog/2017/05/17/2017-05-17-nginx-2/">nginx学习笔记——基础概念</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="connection"><a href="#connection" class="headerlink" title="connection"></a>connection</h3><ul>
<li><p>在nginx中connection就是对tcp连接的封装，其中包括连接的socket，读事件、写事件。</p>
</li>
<li><p>nginx中的http请求的处理就是建立在<code>connection</code>之上的，利用nginx提供的<code>connection</code>，我们可以与任何后端服务打交道。</p>
</li>
<li><p>nginx可以作为客户端来请求其它server的数据的（如<code>upstream</code>模块），与其它server创建的连接，也封装在<code>ngx_connection_t</code>中。<br>流程为：</p>
<blockquote>
<p>①先获取一个<code>ngx_connection_t</code>结构体。②创建socket并设置其属性（ 比如非阻塞）。③通过添加读写事件，调用<code>connect/read/write</code>来调用连接。④关闭连接，并释放<code>ngx_connection_t</code>。</p>
</blockquote>
</li>
<li><p>每个进程会有一个连接数的最大上限,通过<code>ulimit -n</code>可以得到一个进程所能够打开的fd的最大数即nofile。nginx通过设置<code>worker_connectons</code>来设置<em>每个进程支持的最大连接数</em>，如果该值大于nofile，那么实际的最大连接数是nofile。</p>
</li>
<li><p>nginx在实现时，是通过一个连接池来管理的，每个worker进程都有一个独立的连接池，连接池的大小是<code>worker_connections</code>。这里的连接池里面保存的不是真实的连接，它只是一个<code>worker_connections</code>大小的一个<code>ngx_connection_t</code>结构的数组。</p>
</li>
<li><p>nginx会通过一个链表<code>free_connections</code>来保存所有的空闲<code>ngx_connection_t</code>，每次获取一个连接时，就从空闲连接链表中获取一个，用完后，再放回空闲连接链表里面。</p>
</li>
<li><p>因为<code>worker_connections</code>是每个进程的最大连接数，所以整个nginx的总最大连接数为进<em>进程最大连接数x进程数</em>即，<code>worker_connections * worker_processes</code>。</p>
</li>
<li><p>作为反向代理来说，最大并发数量应该是<code>worker_connections * worker_processes/2</code>。因为作为反向代理服务器，每个并发会建立与<code>客户端</code>的连接和与<code>后端服务</code>的连接，会占用两个连接。</p>
</li>
<li><p>在一个连接到来时nginx的worker进程会抢夺<code>accept_mutex</code>，获得<code>accept_mutex</code>的进程才添加accept事件，可以通过<code>ngx_accept_disabled</code>的变量来控制是否去竞争<code>accept_mutex</code>锁。</p>
</li>
</ul>
<p>ngx_accept_disabled控制进程是否抢占连接过程：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * 在第一段代码中，计算ngx_accept_disabled的值，这个值是nginx单进程的所有连接总</span><br><span class="line"> 数的八分之一，减去剩下的空闲连接数量，得到的这个ngx_accept_disabled有一个规律</span><br><span class="line"> ，当剩余连接数小于总连接数的八分之一时，其值才大于0，而且剩余的连接数越小，这</span><br><span class="line"> 个值越大。再看第二段代码，当ngx_accept_disabled大于0时，不会去尝试获取accept_mutex锁，</span><br><span class="line"> 并且将ngx_accept_disabled减1，于是，每次执行到此处时，都会去减1，直到小于0。</span><br><span class="line"> 不去获取accept_mutex锁，就是等于让出获取连接的机会，很显然可以看出，当空余连接越少时，</span><br><span class="line"> ngx_accept_disable越大，于是让出的机会就越多，这样其它进程获取锁的机会也就越大。</span><br><span class="line"> 不去accept，自己的连接就控制下来了，其它进程的连接池就会得到利用，这样，nginx就控制了多进程间连接的平衡了。</span><br><span class="line"> *&#x2F;</span><br><span class="line"></span><br><span class="line">ngx_accept_disabled &#x3D; ngx_cycle-&gt;connection_n &#x2F; 8</span><br><span class="line">    - ngx_cycle-&gt;free_connection_n; &#x2F;&#x2F;剩余连接数</span><br><span class="line"></span><br><span class="line">if (ngx_accept_disabled &gt; 0) &#123; &#x2F;&#x2F;不获取accept_mutex锁</span><br><span class="line">    ngx_accept_disabled--;</span><br><span class="line"></span><br><span class="line">&#125; else &#123;</span><br><span class="line">    if (ngx_trylock_accept_mutex(cycle) &#x3D;&#x3D; NGX_ERROR) &#123;</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (ngx_accept_mutex_held) &#123;</span><br><span class="line">        flags |&#x3D; NGX_POST_EVENTS;</span><br><span class="line"></span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        if (timer &#x3D;&#x3D; NGX_TIMER_INFINITE || timer &gt; ngx_accept_mutex_delay) &#123;</span><br><span class="line">            timer &#x3D; ngx_accept_mutex_delay;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="request"><a href="#request" class="headerlink" title="request"></a>request</h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://l20.github.io/2017/05/17/2017-05-17-nginx-2/" data-id="ck54z725z0004zuwo0vza8egd" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="blog/tags/IT-%E5%89%8D%E7%AB%AF/" rel="tag">IT 前端</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2017-05-16-music" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="blog/2017/05/16/2017-05-16-music/" class="article-date">
  <time datetime="2017-05-16T02:18:00.000Z" itemprop="datePublished">2017-05-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="blog/categories/casper/">casper</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="blog/2017/05/16/2017-05-16-music/">基本乐理基础知识</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="一、基础知识"><a href="#一、基础知识" class="headerlink" title="一、基础知识"></a>一、基础知识</h3><p> 基本乐理的基础知识是作曲家创作乐曲，也象文学家写诗歌、小说一样，有一套表情达意的体系，那就是音乐语言。音乐语言包括很多要素：旋律、节奏、节拍、速度、力度、音区、音色、和声、复调、调式、调性等。一首音乐作品的思想内容和艺术美，要通过多种要素才能表现出来。<br>    【旋律】又称曲调，它是按照一定的高低、长短和强弱关系而组成的音的线条。它是塑造音乐形象最主要的手段，是音乐的灵魂。<br>    【节奏】各音在进行时的长短关系和强弱关系。由于不同高低的音同时也是不同长短和不同强弱的音，因此旋律中必须包括节奏这一要素。<br>    【节拍】强拍和弱拍的均匀的交替。节拍有多种不同的组合方式，叫?quot;拍子’’，正常的节奏是按照一定的拍子而进行的。<br>    【速度】快慢的程度。为使音乐准确地表达出所要表现的思想感情，必须使作品按一定的速度演唱或演奏。<br>    【力度】强弱的程度。音的强弱变化对音乐形象的塑造也起着很重要的作用。<br>    【音区】音的高低范围。不同音区的音在表达思想感情时各有不同的功能和特点。<br>    【音色】不同人声、不同乐器及不同组合的音响上的特色。通过音色的对比和变化，可以丰富和加强音乐的表现力。<br>    【和声】两个以上的音按一定规律同时结合。和弦进行的强和弱、稳定与不稳定、协和与不协和，以及不稳定、不协和和弦对稳定、协和和弦的倾向性，构成了和声的功能体系。和声的功能作用，直接影响到力度的强弱、节奏的松紧和动力的大小。此外，和声的音响效果还有明暗的区别和疏密浓淡之分，从而使和声具有渲染色彩的作用。<br>    【复调】两个或几个旋律的同时结合。不同旋律的同时结合叫做对比复调，同一旋律隔开一定肘间的先后模仿称为模仿复调。运用复调手法，可以丰富音乐形象，加强音乐发展的气势和声部的独立性，造成前呼后应、此起彼落的效果。<br>    【调式】从音乐作品的旋律与和声中所用的高低不同的音归纳出来的音列。这些音互相联系并保持着一定的倾向性。而调性则是调式的中心音（主音）的音高。在许多音乐作品中，调式和调性的转换和对比，是体现气氛、色彩、情绪和形象变化的重要手法。<br>    音乐语言的各种要素互相配合，具有千变万化的表现力。旋律尽管是音乐的灵魂，但其它要素起了变化，音乐形象就会有不同程度的改变。在一定条件下，其它要素甚至可起重要作用。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://l20.github.io/2017/05/16/2017-05-16-music/" data-id="ck54z725l0000zuwogglaeyh9" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="blog/tags/%E9%9F%B3%E4%B9%90/" rel="tag">音乐</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2017-06-05-test-yunxiao" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="blog/2017/05/16/2017-06-05-test-yunxiao/" class="article-date">
  <time datetime="2017-05-16T02:18:00.000Z" itemprop="datePublished">2017-05-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="blog/categories/casper/">casper</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="blog/2017/05/16/2017-06-05-test-yunxiao/">笔试经历</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>下面是我的笔试所经历是试题，面完试自我感觉良好，可是一回来重做一遍想撞墙，记录下来当做爬坑经历,最主要是js的问题,基础不行还是无缘加入这家公司了。</p>
<h5 id="1-以下代码会输出什么？"><a href="#1-以下代码会输出什么？" class="headerlink" title="1.以下代码会输出什么？"></a>1.以下代码会输出什么？</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">person</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line"> <span class="keyword">if</span> (name) </span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line"> <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">person.prototype.name = <span class="string">'Tom'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> human = &#123;</span><br><span class="line">    person : person,</span><br><span class="line">    name : <span class="string">'Cat'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">person()            <span class="comment">// ''</span></span><br><span class="line">person(<span class="string">'Jack'</span>)      <span class="comment">//Jack</span></span><br><span class="line"><span class="keyword">new</span> person()        <span class="comment">//Tom</span></span><br><span class="line"><span class="keyword">new</span> person(<span class="string">'Rose'</span>)  <span class="comment">//Rose</span></span><br><span class="line">human.person()      <span class="comment">//Cat</span></span><br><span class="line">person.call(<span class="built_in">window</span>) <span class="comment">//Jack</span></span><br></pre></td></tr></table></figure>

<p>这里是要考察函数<code>this</code>指向的问题，分析之前先搞清楚函数<code>this</code>的指向：</p>
<blockquote>
<p>情况1：如果一个函数中有this，但是它没有被上一级的对象所调用，那么this指向的就是window。</p>
</blockquote>
<blockquote>
<p>情况2：如果一个函数中有this，这个函数有被上一级的对象所调用，那么this指向的就是上一级的对象。</p>
</blockquote>
<blockquote>
<p>情况3：如果一个函数中有this，这个函数中包含多个对象，尽管这个函数是被最外层的对象所调用，this指向的也只是它上一级的对象。</p>
</blockquote>
<p>摘自博客<a href="http://www.cnblogs.com/pssp/p/5216085.html" target="_blank" rel="noopener">http://www.cnblogs.com/pssp/p/5216085.html</a></p>
<p>之后来看</p>
<figure class="highlight plain"><figcaption><span>``` 会输出空,当做普通函数执行此时```this.name```为空无异议。</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&#96;&#96;&#96;person(&#39;Jack&#39;)&#96;&#96;&#96; 这里输出 &#96;&#96;&#96;Jack&#96;&#96;&#96; 也无异议，当做普通函数来传参并执行，不过需要注意的是这里当做普通函数来执行之后&#96;&#96;&#96;this&#96;&#96;&#96;指向了全局浏览器中的&#96;&#96;&#96;window&#96;&#96;&#96;对象，此时的&#96;&#96;&#96;this.name&#96;&#96;&#96;相当于&#96;&#96;&#96;window.name&#96;&#96;&#96;。</span><br><span class="line">&#96;&#96;&#96;new person() &#x2F;&#x2F;Tom&#96;&#96;&#96;,加了&#96;&#96;&#96;new&#96;&#96;&#96;之后的情况，先来了解下&#96;&#96;&#96;new&#96;&#96;&#96;到底干了什么？</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96; js</span><br><span class="line">    var obj  &#x3D; &#123;&#125;; </span><br><span class="line">    obj.__proto__ &#x3D; Base.prototype;</span><br><span class="line">    Base.call(obj);  </span><br><span class="line">&#96;&#96;&#96;    </span><br><span class="line">+ 第一行，我们创建了一个空对象obj。</span><br><span class="line">+ 第二行，我们将这个空对象的__proto__成员指向了Base函数对象prototype成员对象。</span><br><span class="line">+ 第三行，我们将Base函数对象的this指针替换成obj，然后再调用Base函数，于是我们就给obj对象赋值了一个id成员变量，这个成员变量的值是”base”。</span><br><span class="line"></span><br><span class="line">由此，通过&#96;&#96;&#96;new&#96;&#96;&#96;之后创建了一个指向&#96;&#96;&#96;person&#96;&#96;&#96;的对象，在执行到&#96;&#96;&#96; console.log(this.name)&#96;&#96;&#96;后js解释器会现在本地（person的上下文）查找有关&#96;&#96;&#96;name&#96;&#96;&#96;属性，但是没有找到，又去原型链中查找，终于发现了个&#96;&#96;&#96;name&#96;&#96;&#96;属性，所以就引用了这个属性的值。</span><br><span class="line">&#96;&#96;&#96;new person(&#39;Rose&#39;)  &#x2F;&#x2F;Rose&#96;&#96;&#96;自然就不用解释了。</span><br><span class="line">&#96;&#96;&#96;human.person()      &#x2F;&#x2F;Cat&#96;&#96;&#96;，函数的&#96;&#96;&#96;this&#96;&#96;&#96;指向调用它的上下文。</span><br><span class="line"></span><br><span class="line">##### 2.以下代码会输出什么？</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;js</span><br><span class="line">    var str &#x3D; &#39;hello&#39;;</span><br><span class="line"></span><br><span class="line">    function hello(str)&#123;</span><br><span class="line">        var str;</span><br><span class="line">        console.log(str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    hello(&#39;kitty&#39;)      &#x2F;&#x2F; kitty</span><br><span class="line">    console.log(str)    &#x2F;&#x2F; hello</span><br></pre></td></tr></table></figure>

<p>以上，创建上下文的时候会提升所有的变量声明和函数声明，会在这里找变量发现<code>function (str)</code>这里有个<code>str</code>变量先提升，给个默认值<code>undefined</code>然后发现没有别的变量了,里面的str由于跟参数列表里的str是同名的，所以只会提升一次，不会覆盖<br>而在执行的时候，var str这个事函数声明，它已经在创建执行上下文的时候提升了，所以直接略过</p>
<h5 id="3-以下代码会输出什么？"><a href="#3-以下代码会输出什么？" class="headerlink" title="3.以下代码会输出什么？"></a>3.以下代码会输出什么？</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="built_in">window</span>.a = <span class="string">'hello'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hello</span>(<span class="params">a</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(a)</span><br><span class="line">    <span class="keyword">var</span> a = <span class="string">'kitty'</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(a);</span><br><span class="line">&#125;</span><br><span class="line">hello(); <span class="comment">// undefined</span></span><br><span class="line">         <span class="comment">// kitty</span></span><br></pre></td></tr></table></figure>

<h5 id="4-以下代码会输出什么？"><a href="#4-以下代码会输出什么？" class="headerlink" title="4.以下代码会输出什么？"></a>4.以下代码会输出什么？</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">T</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = <span class="string">'t'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">B</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = <span class="string">'b'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> t = <span class="keyword">new</span> T();</span><br><span class="line">T.prototype = B.prototype;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(t <span class="keyword">instanceof</span> T); <span class="comment">// fasle</span></span><br><span class="line"><span class="built_in">console</span>.log(t <span class="keyword">instanceof</span> B); <span class="comment">// fasle</span></span><br></pre></td></tr></table></figure>

<h5 id="5-以下代码会输出什么？"><a href="#5-以下代码会输出什么？" class="headerlink" title="5.以下代码会输出什么？"></a>5.以下代码会输出什么？</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    bar : <span class="number">1</span>,</span><br><span class="line">    foo : <span class="number">2</span>,</span><br><span class="line">    baz : <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">obj.bar = <span class="literal">undefined</span>;</span><br><span class="line">obj.foo = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">delete</span> obj.baz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> obj) &#123;</span><br><span class="line">    <span class="keyword">if</span> (obj.hasOwnProperty(i)) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//bar</span></span><br><span class="line"><span class="comment">//foo</span></span><br></pre></td></tr></table></figure>

<h5 id="6-以下代码会输出什么？"><a href="#6-以下代码会输出什么？" class="headerlink" title="6.以下代码会输出什么？"></a>6.以下代码会输出什么？</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Dog</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">Dog.prototype.name = <span class="string">'dog'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> Dog();</span><br><span class="line"> </span><br><span class="line"><span class="built_in">console</span>.log(d.name);  <span class="comment">// dog</span></span><br><span class="line"></span><br><span class="line">Dog.prototype.name = <span class="string">'hotdog'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(d.name); <span class="comment">// hotdog</span></span><br><span class="line"></span><br><span class="line">d.name = <span class="string">'baddog'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(d.name); <span class="comment">// baddog</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> d.name;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(d.name); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://l20.github.io/2017/05/16/2017-06-05-test-yunxiao/" data-id="ck54z7265000azuwo6lp38aua" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="blog/tags/IT/" rel="tag">IT</a></li></ul>

    </footer>
  </div>
  
</article>


  


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="blog/categories/casper/">casper</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="blog/tags/IT/" rel="tag">IT</a></li><li class="tag-list-item"><a class="tag-list-link" href="blog/tags/IT-%E5%89%8D%E7%AB%AF/" rel="tag">IT 前端</a></li><li class="tag-list-item"><a class="tag-list-link" href="blog/tags/%E9%9F%B3%E4%B9%90/" rel="tag">音乐</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="blog/tags/IT/" style="font-size: 10px;">IT</a> <a href="blog/tags/IT-%E5%89%8D%E7%AB%AF/" style="font-size: 20px;">IT 前端</a> <a href="blog/tags/%E9%9F%B3%E4%B9%90/" style="font-size: 10px;">音乐</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="blog/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="blog/archives/2017/05/">五月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="blog/2020/01/08/2017-05-22-vue-cli/">2017-05-22-vue-cli</a>
          </li>
        
          <li>
            <a href="blog/2020/01/08/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="blog/2017/05/18/2017-05-17-nginx-config/">nginx.config配置文件说明</a>
          </li>
        
          <li>
            <a href="blog/2017/05/17/2017-05-17-nginx-1/">nginx学习笔记——架构</a>
          </li>
        
          <li>
            <a href="blog/2017/05/17/2017-05-17-nginx-2/">nginx学习笔记——基础概念</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 Loksin<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="blog/" class="mobile-nav-link">Home</a>
  
    <a href="blog/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="blog/fancybox/jquery.fancybox.css">

  
<script src="blog/fancybox/jquery.fancybox.pack.js"></script>




<script src="blog/js/script.js"></script>




  </div>
</body>
</html>